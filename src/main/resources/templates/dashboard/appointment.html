<!doctype html>
<html class="theme-fs-sm" data-bs-theme="light" data-bs-theme-color="default" dir="ltr" lang="vi"
      layout:decorate="~{/dashboard/layouts/main-layout}"
      th:with="breadCrumbTitle = ${'Danh sách lịch hẹn'}, navItem= ${'appointment'}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
>
<head>
    <title>Danh sách lịch hẹn</title>
</head>
<body>
<div class="card" layout:fragment="content">
    <div class="card-header">
        <div class="row align-items-center gy-3">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white mb-0">
                    <h5 class="mb-4 text-white">Tìm kiếm lịch hẹn</h5>
                </div>
                <div class="card-body">
                    <form id="filter" th:object="${appointmentDTO}">
                        <!-- Hàng 1: ID, Bệnh nhân, Email bệnh nhân -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label" for="patientName">Tên bệnh nhân</label>
                                <input class="form-control" id="patientName" placeholder="Nhập tên bệnh nhân"
                                       th:field="*{patientEntityFullName}" type="text">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" for="patientEmail">Email bệnh nhân</label>
                                <input class="form-control" id="patientEmail" placeholder="Nhập email bệnh nhân"
                                       th:field="*{patientEntityEmail}" type="email">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" for="serviceName">Tên dịch vụ</label>
                                <input class="form-control" id="serviceName"
                                       placeholder="Nhập tên dịch vụ"
                                       th:field="*{serviceEntityProductEntityName}" type="text">
                            </div>
                        </div>

                        <!-- Hàng 2: Bác sĩ, Người xếp lịch, Trạng thái -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label" for="doctorName">Tên bác sĩ</label>
                                <input class="form-control" id="doctorName"
                                       placeholder="Nhập tên bác sĩ"
                                       th:field="*{doctorEntityStaffEntityFullName}" type="text">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" for="creatorName">Người xếp lịch</label>
                                <input class="form-control" id="creatorName"
                                       placeholder="Nhập tên người xếp lịch"
                                       th:field="*{schedulingCoordinatorEntityStaffEntityFullName}" type="text">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" for="status">Trạng thái</label>
                                <select class="form-select" id="status" name="status">
                                    <option value="">Tất cả trạng thái</option>
                                    <option value="PENDING">Chờ duyệt</option>
                                    <option value="CONFIRMED">Đã xác nhận</option>
                                    <option value="CANCELLED">Đã hủy</option>
                                    <option value="IN_PROGRESS">Đang khám</option>
                                    <option value="COMPLETED">Đã hoàn thành</option>
                                    <option value="CONFLICTED">Xung đột lịch</option>
                                </select>
                            </div>
                        </div>

                        <!-- Hàng 3: Sắp xếp -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label" for="sortField">Sắp xếp theo</label>
                                <select class="form-select" id="sortField" name="sortFieldName">
                                    <option value="">Không sắp xếp</option>
                                    <option value="patientEntity.fullName">Tên bệnh nhân</option>
                                    <option value="patientEntity.email">Email bệnh nhân</option>
                                    <option value="serviceEntity.productEntity.name">Tên dịch vụ</option>
                                    <option value="doctorEntity.staffEntity.fullName">Tên bác sĩ</option>
                                    <option value="schedulingCoordinator.staffEntity.fullName">Người xếp lịch</option>
                                    <option value="appointmentStatus">Trạng thái</option>
                                    <option value="startTime">Ngày hẹn</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" for="sortOrder">Thứ tự</label>
                                <select class="form-select" id="sortOrder" name="sortDirection">
                                    <option value="ASC">Tăng dần</option>
                                    <option value="DESC">Giảm dần</option>
                                </select>
                            </div>
                            <div class="col-4 d-flex align-items-end justify-content-center text-end">
                                <button class="btn btn-outline-secondary me-2" type="reset">
                                    <i class="fas fa-undo me-1"></i> Đặt lại
                                </button>
                                <button class="btn btn-primary" type="submit">
                                    <i class="fas fa-search me-1"></i> Tìm kiếm
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="card-body pt-0">
        <!-- Nav tabs content -->
        <div class="tab-content">
            <div class="tab-pane active" id="upcoming" role="tabpanel">
                <div class="table-responsive">
                    <table class="table border-end border-start align-middle rounded">
                        <thead class="table-dark">
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Bệnh nhân</th>
                            <th scope="col">Email bệnh nhân</th>
                            <th scope="col">Dịch vụ</th>
                            <th scope="col">Bác sĩ</th>
                            <th scope="col">Người xếp lịch</th>
                            <th scope="col">Ngày hẹn</th>
                            <th scope="col">Thời lượng</th>
                            <th scope="col">Trạng thái</th>
                        </tr>
                        </thead>
                        <tbody id="list"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="pagination"></div>
    </div>
</div>
<th:block layout:fragment="custom-js">
    <script type="module">
        import {
            AppointmentResponse, renderAppointmentResponseAdmin
        } from "/templates/shared/assets/js/model/response/AppointmentResponse.js";
        import {CrudUtils} from "/templates/shared/assets/js/utils/crud-utils.js";

        document.addEventListener("DOMContentLoaded", async () => {
            const crudUtils = new CrudUtils({
                apiUrl: "/api/admin/appointment",
                responseClass: AppointmentResponse,
                renderStrategy: renderAppointmentResponseAdmin
            });
            await crudUtils.init();
        });
    </script>
</th:block>
</body>
</html>
